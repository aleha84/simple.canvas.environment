function Vector2(n,t){typeof n=="object"?(t=n.y,n=n.x):(n==undefined&&(n=0),t==undefined&&(t=0));this.x=n;this.y=t}function getRandom(n,t){return Math.random()*(t-n)+n}function getRandomInt(n,t){return Math.round(getRandom(n,t))}function boxIntersectsBox(n,t){return Math.abs(n.center.x-t.center.x)*2<n.size.x+t.size.x&&Math.abs(n.center.y-t.center.y)*2<n.size.y+t.size.y}function boxCircleIntersects(n,t){var i=new Vector2(Math.abs(n.center.x-t.center.x),Math.abs(n.center.y-t.center.y)),r;return i.x>t.size.x/2+n.radius?!1:i.y>t.size.y/2+n.radius?!1:i.x<=t.size.x/2?!0:i.y<=t.size.y/2?!0:(r=Math.pow(i.x-t.size.x/2,2)+Math.pow(i.y-t.size.y/2,2),r<=Math.pow(n.radius,2))}function segmentIntersectBox(n,t){var u=n.begin.x,f=n.end.x,e,o,h;if(n.begin.x>n.end.x&&(u=n.end.x,f=n.begin.x),f>t.bottomRight.x&&(f=t.bottomRight.x),u<t.topLeft.x&&(u=t.topLeft.x),u>f)return!1;var i=n.begin.y,r=n.end.y,s=n.end.x-n.begin.x;return(Math.abs(s)>1e-7&&(e=(n.end.y-n.begin.y)/s,o=n.begin.y-e*n.begin.x,i=e*u+o,r=e*f+o),i>r&&(h=r,r=i,i=h),r>t.bottomRight.y&&(r=t.bottomRight.y),i<t.topLeft.y&&(i=t.topLeft.y),i>r)?!1:!0}function segmentIntersectCircle(n,t){var u=n.end.substract(n.begin,!0),f=n.begin.substract(t.center,!0),e=u.dot(u),r=2*f.dot(u),h=f.dot(f)-Math.pow(t.radius,2),i=r*r-4*e*h,o,s;return i<0?!1:(i=Math.sqrt(i),o=(-r-i)/(2*e),s=(-r+i)/(2*e),o>=0&&o<=1)?!0:s>=0&&s<=1?!0:!1}function segmentIntersectCircle2(n,t){var i=t.center.distance(n.begin),r=t.center.distance(n.end);return i<=t.radius||r<=t.radius}function segmentsIntersectionVector2(n,t){var i=+n.begin.x.toFixed(2),r=+n.end.x.toFixed(2),u=+n.begin.y.toFixed(2),f=+n.end.y.toFixed(2),e=+t.begin.x.toFixed(2),o=+t.end.x.toFixed(2),s=+t.begin.y.toFixed(2),h=+t.end.y.toFixed(2),a=(i-r)*(s-h)-(u-f)*(e-o);if(a==0)return undefined;var c=+(((e-o)*(i*f-u*r)-(i-r)*(e*h-s*o))/a).toFixed(2),l=+(((s-h)*(i*f-u*r)-(u-f)*(e*h-s*o))/a).toFixed(2),v=new Vector2(c,l);return c<Math.min(i,r)||c>Math.max(i,r)?undefined:c<Math.min(e,o)||c>Math.max(e,o)?undefined:l<Math.min(u,f)||l>Math.max(u,f)?undefined:l<Math.min(s,h)||l>Math.max(s,h)?undefined:v}function segmentsIntersection(n,t){var i=n.begin.directionNonNormal(t.begin),r=n.begin.directionNonNormal(n.end),u=t.begin.directionNonNormal(t.end),f=i.x*r.y-i.y*r.x,c=i.x*u.y-i.y*u.x,e=r.x*u.y-r.y*u.x;if(f==0)return t.begin.x-n.begin.x<0!=t.begin.x-n.end.x<0||t.begin.y-n.begin.y<0!=t.begin.y-n.end.y<0;if(e==0)return!1;var o=1/e,s=c*o,h=f*o;return s>=0&&s<=1&&h>=0&&h<=1}function radiansToDegree(n){return n===undefined?0:n*180/Math.PI}function degreeToRadians(n){return n===undefined?0:n*Math.PI/180}function isBoolean(n){return n.constructor===Boolean||typeof n=="boolean"}function isString(){return typeof myVar=="string"||myVar instanceof String}function isArray(n){return Object.prototype.toString.call(n)==="[object Array]"}function isFunction(n){return typeof n=="function"}function absorbTouchEvent(n){if(n.type=="touchstart"||n.type=="touchmove"||n.type=="touchend"||n.type=="touchcancel"){var t=n||window.event;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1}}function checkClamps(n,t){return!isArray(n)||isEmpty(n)?1:(t>n[1]?t=n[1]:t<n[0]&&(t=n[0]),t==n[0]||t==n[1])?-1:1}function isBetween(n,t,i){if(t>i){var r=i;i=t;t=r}return n>=t&&n<=i}function isEmpty(n){if(n==null)return!0;if(n.length>0)return!1;if(n.length===0)return!0;for(var t in n)if(hasOwnProperty.call(n,t))return!1;return!0}function sqr(n){return n*n}function dist2(n,t){return sqr(n.x-t.x)+sqr(n.y-t.y)}function distToSegmentSquared(n,t,i){var u=dist2(t,i),r;return u==0?dist2(n,t):(r=((n.x-t.x)*(i.x-t.x)+(n.y-t.y)*(i.y-t.y))/u,r<0)?dist2(n,t):r>1?dist2(n,i):dist2(n,{x:t.x+r*(i.x-t.x),y:t.y+r*(i.y-t.y)})}function distToSegment(n,t,i){return Math.sqrt(distToSegmentSquared(n,t,i))}function getDegreeToVectorUp(n,t){var i=Vector2.up(),r=t.substract(n,!0);return Math.acos(r.mulVector(i)/(r.module()*i.module()))}function doWorkByTimer(n,t){if(SCG.gameLogics.isPaused){n.delta=0;return}n.delta=t-n.lastTimeWork;SCG.gameLogics.pauseDelta!=0&&(n.delta-=SCG.gameLogics.pauseDelta);n.currentDelay-=n.delta;n.currentDelay<=0&&(n.currentDelay=n.originDelay,n.doWorkInternal.call(n.context));n.lastTimeWork=t}function extend(){var f,u,i,t,e,o,n=arguments[0]||{},r=1,h=arguments.length,s=!1;for(typeof n=="boolean"&&(s=n,n=arguments[r]||{},r++),typeof n=="object"||isFunction(n)||(n={}),r===h&&(n=this,r--);r<h;r++)if((f=arguments[r])!=null)for(u in f)(i=n[u],t=f[u],n!==t)&&(s&&t&&(isPlainObject(t)||(e=isArray(t)))?(e?(e=!1,o=i&&isArray(i)?i:[]):o=i&&isPlainObject(i)?i:{},n[u]=extend(s,o,t)):t!==undefined&&(n[u]=t));return n}function isPlainObject(n){var t,i,f=Object.prototype.toString,r=Object.prototype.hasOwnProperty,u=r.toString,e=u.call(Object);return!n||f.call(n)!=="[object Object]"?!1:(t=getProto(n),!t)?!0:(i=r.call(t,"constructor")&&t.constructor,typeof i=="function"&&u.call(i)===e)}function getDOMByClassName(n){var t=undefined,i=document.getElementsByClassName(n);return i.length>0&&(t=i[0]),t}function appendDomElement(n,t,i){if(!(n instanceof HTMLElement)&&!(n instanceof HTMLDocument)&&!(n instanceof HTMLBodyElement))throw"Cant append new element to non html Node";if(t!=undefined&&typeof t!="string")throw"Type must be a string";var r=document.createElement(t);return setAttributes(r,i),n.appendChild(r),r}function setAttributes(n,t){var i,r,u,f,e;for(i in t)if(t.hasOwnProperty(i))if(i=="on"){r=t[i];for(u in r)r.hasOwnProperty(u)&&n.addEventListener(u,r[u],!1)}else if(i=="css"){f=t[i];for(e in f)f.hasOwnProperty(e)&&(n.style[e]=f[e])}else n.setAttribute(i,t[i])}function addListenerMulti(n,t,i){t.split(" ").forEach(function(t){n.addEventListener(t,i,!1)})}function drawFigures(n,t,i){var f,r,u;for(i==undefined&&(i=1),n.globalAlpha=i,f=0;f<t.length;f++)if(r=t[f],!(r.length<3)){for(n.beginPath(),n.moveTo(r[0].x,r[0].y),u=1;u<r.length;u++)n.lineTo(r[u].x,r[u].y);n.fill()}}function Box(n,t){this.topLeft=n;this.size=t;this.center=new Vector2(this.topLeft.x+t.x/2,this.topLeft.y+t.y/2);this.bottomRight=new Vector2(this.topLeft.x+this.size.x,this.topLeft.y+this.size.y);this.topRight=new Vector2(this.bottomRight.x,this.topLeft.y);this.bottomLeft=new Vector2(this.topLeft.x,this.bottomRight.y);this.update=function(n,t){this.topLeft=n;t!==undefined&&(this.size=t);this.center=new Vector2(this.topLeft.x+this.size.x/2,this.topLeft.y+this.size.y/2);this.bottomRight=new Vector2(this.topLeft.x+this.size.x,this.topLeft.y+this.size.y)};this.isPointInside=function(n){return n instanceof Vector2&&this.topLeft.x<=n.x&&n.x<=this.bottomRight.x&&this.topLeft.y<=n.y&&n.y<=this.bottomRight.y};this.isIntersectsWithCircle=function(n){return boxCircleIntersects(n,this)};this.isIntersectsWithBox=function(n){return boxIntersectsBox(this,n)};this.render=function(n){var t={fillStyle:"rgba(0, 255, 0, 0.5)",lineWidth:1,strokeStyle:"#00FF00"};isBoolean(n)?t.fill=n:extend(t,n);SCG.context.beginPath();SCG.context.rect(this.topLeft.x,this.topLeft.y,this.size.x,this.size.y);t.fill&&(SCG.context.fillStyle=t.fillStyle,SCG.context.fill());SCG.context.lineWidth=t.lineWidth;SCG.context.strokeStyle=t.strokeStyle;SCG.context.closePath();SCG.context.stroke()}}function Circle(n,t){n instanceof Vector2?(this.center=n,this.radius=t):n instanceof Object&&n.center!==undefined&&n.radius!==undefined&&(this.center=n.center,this.radius=n.radius);this.update=function(n){this.radius=n};this.render=function(n,t){var i={fillStyle:"rgba(255, 255, 0, 0.5)",lineWidth:1,strokeStyle:"#FFFF00"},r;isBoolean(n)?i.fill=n:extend(i,n);t!==undefined&&isString(t)&&(i.fillStyle=t,i.strokeStyle=t);r=SCG.context;r.beginPath();r.arc(this.center.x,this.center.y,this.radius,0,2*Math.PI,!1);i.fill&&(r.fillStyle=i.fillStyle,r.fill());r.lineWidth=i.lineWidth;r.strokeStyle=i.strokeStyle;r.stroke()};this.clone=function(){return new Circle(this.center,this.radius)}}function Line(n){this.begin=new Vector2;this.end=new Vector2;this.color="#ffffff";this.width=1;extend(this,n);this.render=function(){var n=SCG.context;n.beginPath();n.moveTo(this.begin.x,this.begin.y);n.lineTo(this.end.x,this.end.y);n.lineWidth=this.width;n.strokeStyle=this.color;n.stroke()};this.update=function(n){extend(this,n)};this.calculateBoundingSphere=function(){var n=new Vector2((this.end.x-this.begin.x)/2,(this.end.y-this.begin.y)/2),t=this.begin.distance(this.end)/2;return new Circle(n,t)};this.calculateBoundingBox=function(){var n=new Vector2,t;return n.x=this.begin.x<this.end.x?this.begin.x:this.end.x,n.y=this.begin.y<this.end.y?this.begin.y:this.end.y,t=new Vector2(Math.abs(this.end.x-this.begin.x),Math.abs(this.end.y-this.begin.x)),new Box(n,t)}}function Poligon(n){if(this.vertices=n.vertices,this.renderOptions=n.renderOptions,this.defaults={fillStyle:"rgba(255, 255, 0, 0.5)",strokeStyle:"#FF0000",lineWidth:2,fill:!1},this.vertices.length<3)throw"Poligon -> vertices lenght mustbe >= 3";this.renderOptions||(this.renderOptions={});var t=this.renderOptions;t.fillStyle?this.defaults.fillStyle=t.fillStyle:t.fillStyle=this.defaults.fillStyle;t.lineWidth?this.defaults.lineWidth=t.lineWidth:t.lineWidth=this.defaults.lineWidth;t.strokeStyle?this.defaults.strokeStyle=t.strokeStyle:t.strokeStyle=this.defaults.strokeStyle;t.fill?this.defaults.fill=t.fill:t.fill=this.defaults.fill;this.resetToDefaults=function(){t.fillStyle=this.defaults.fillStyle;t.strokeStyle=this.defaults.strokeStyle;t.lineWidth=this.defaults.lineWidth;t.fill=this.defaults.fill};this.clone=function(){return new Poligon({vertices:this.vertices.map(function(n){return n.clone()})})};this.update=function(n,t){for(var i=this.vertices.length-1;i>=0;i--)this.vertices[i].rotate(t,!0,!0),this.vertices[i].add(n,!0)};this.render=function(){var n=SCG.context,t;for(n.beginPath(),n.moveTo(this.vertices[0].x,this.vertices[0].y),t=1;t<this.vertices.length;t++)n.lineTo(this.vertices[t].x,this.vertices[t].y);n.lineWidth=this.renderOptions.lineWidth;n.strokeStyle=this.renderOptions.strokeStyle;n.closePath();this.renderOptions.fill&&(n.fillStyle=this.renderOptions.fillStyle,n.fill());n.stroke()};this.isPointInside=function(n){for(var r,u,f=0,i=n.x,t=0;t<this.vertices.length;t++)this.vertices[t].x>i&&(i=this.vertices[t].x);for(i+=1,t=0;t<this.vertices.length;t++)r=this.vertices[t].clone(),u=this.vertices[t==this.vertices.length-1?0:t+1].clone(),n.y==r.y&&(r.y-=.01),n.y==u.y&&(u.y-=.01),segmentsIntersectionVector2(new Line({begin:n,end:new Vector2(i,n.y)}),new Line({begin:r,end:u}))&&f++;return f>0&&f%2!=0}}var V2,pointerEventToXY,getProto;Vector2.prototype={distance:function(n){return!n||!(n instanceof Vector2)?undefined:new Vector2(n.x-this.x,n.y-this.y).module()},directionNonNormal:function(n){return!n||!(n instanceof Vector2)?new Vector2:new Vector2(n.x-this.x,n.y-this.y)},direction:function(n){return!n||!(n instanceof Vector2)?new Vector2:new Vector2(n.x-this.x,n.y-this.y).normalize()},normalize:function(){var n=this.module();return this.x/=n,this.y/=n,this},module:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},add:function(n,t){return t===undefined&&(t=!1),n instanceof Vector2?t?(this.x+=n.x,this.y+=n.y,this):new Vector2(this.x+n.x,this.y+n.y):void 0},substract:function(n,t){return(t===undefined&&(t=!1),n instanceof Vector2)?t?(this.x-=n.x,this.y-=n.y,this):new Vector2(this.x-n.x,this.y-n.y):new Vector2},mul:function(n){return new Vector2(this.x*n,this.y*n)},division:function(n){return new Vector2(this.x/n,this.y/n)},dot:function(n){return this.mulVector(n)},cross:function(n){return!n||!(n instanceof Vector2)?0:this.x*n.y-this.y*n.x},mulVector:function(n){return!n||!(n instanceof Vector2)?0:this.x*n.x+this.y*n.y},rotate:function(n,t,i){t===undefined&&(t=!1);i===undefined&&(i=!1);var r=new Vector2(this.x*Math.cos(t?n:n*Math.PI/180)-this.y*Math.sin(t?n:n*Math.PI/180),this.x*Math.sin(t?n:n*Math.PI/180)+this.y*Math.cos(t?n:n*Math.PI/180));return i?(this.x=r.x,this.y=r.y,this):r},clone:function(){return new Vector2(this.x,this.y)},equal:function(n){return!n||!(n instanceof Vector2)?!1:this.x==n.x&&this.y==n.y},toString:function(){return"x: "+this.x+", y: "+this.y},angleTo:function(n,t){if(!n||!(n instanceof Vector2))throw"Param is not a vetor2 instance";t==undefined&&(t=!1);var i=Math.atan2(this.cross(n),this.dot(n));return t?i:i*180/Math.PI}};Vector2.average=function(n){var i,t;if(!isArray(n)||isEmpty(n))throw"Param is not defined";for(i=new Vector2,t=0;t<n.length;t++)i.add(n[t],!0);return i.division(n.length)};Vector2.left=function(){return new Vector2(-1,0)};Vector2.right=function(){return new Vector2(1,0)};Vector2.up=function(){return new Vector2(0,-1)};Vector2.down=function(){return new Vector2(0,1)};V2=Vector2;pointerEventToXY=function(n){var t={x:0,y:0},i;return n.type=="touchstart"||n.type=="touchmove"||n.type=="touchend"||n.type=="touchcancel"?(i=n.touches[0]||n.changedTouches[0],t.x=i.pageX,t.y=i.pageY):(n.type=="mousedown"||n.type=="mouseup"||n.type=="mousemove"||n.type=="mouseover"||n.type=="mouseout"||n.type=="mouseenter"||n.type=="mouseleave"||n.type=="click")&&(t.x=n.pageX,t.y=n.pageY),t};getProto=Object.getPrototypeOf||function(n){return n.__proto__};String.format||(String.format=function(n){var t=Array.prototype.slice.call(arguments,1);return n.replace(/{(\d+)}/g,function(n,i){return typeof t[i]!="undefined"?t[i]:n})});